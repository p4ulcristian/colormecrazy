{"version":3,"sources":["features/app/settings/frontend/view.cljs"],"mappings":";AAaA,IAAAA,iBAAA;IAAAC,iBAEC,WAAKE,GAAGC;AAAR,AACE,6BAAA,mFAAA,6DAAA,qEAAA,3OAACC,mBAASF;;AAHb,AAAA,uIAAAH,eAAAC,gEAAAD,eAAAC,pOAACC,oEAAAA,mGAAAA;AAKD,IAAAI,iBAAA;IAAAC,iBAEC,cAAAC,HAAKL;AAAL,AAAA,IAAAM,aAAAD;QAAA,AAAAE,4CAAAD,WAAA,IAAA,/DAASL;oBAAT,AAAAM,4CAAAD,WAAA,IAAA,3EAAWE;AAAX,6CACMR,nBACA,sBAAA,mFAAA,6DAAA,tKAACE,mOAA2BM,7PAC5B,4QAAA,mFAAA,6DAAA,qEAAA,1dAACN;;AALR,AAAA,uIAAAC,eAAAC,gEAAAD,eAAAC,pOAACL,oEAAAA,mGAAAA;AAOD,IAAAU,iBAAA;IAAAC,iBAEC,cAAAC,HAAKX;AAAL,AAAA,IAAAY,aAAAD;QAAA,AAAAJ,4CAAAK,WAAA,IAAA,/DAASX;YAAT,AAAAM,4CAAAK,WAAA,IAAA,nEAAWC;AAAX,6CACMb,nBACA,sBAAA,mFAAA,6DAAA,tKAACE,qOAA4BW,/PAC7B,sQAAA,mFAAA,6DAAA,qEAAA,pdAACX;;AALR,AAAA,uIAAAO,eAAAC,gEAAAD,eAAAC,pOAACX,oEAAAA,mGAAAA;AAOD,IAAAe,iBAAA;IAAAC,iBAEC,cAAAC,HAAKhB;AAAL,AAAA,IAAAiB,aAAAD;QAAA,AAAAT,4CAAAU,WAAA,IAAA,/DAAShB;WAAT,AAAAM,4CAAAU,WAAA,IAAA,lEAAWC;YAAX,AAAAX,4CAAAU,WAAA,IAAA,nEAAgBE;AAAhB,AACE,OAACjB,mBAASF,GAAG,+CAAA,mFAAA,6DAAA,/LAACoB,4PAAyBF,MAAMC;;AAHhD,AAAA,uIAAAL,eAAAC,gEAAAD,eAAAC,pOAAChB,oEAAAA,mGAAAA;AAKD,IAAAsB,iBAAA;IAAAC,iBAEC,cAAAC,HAAKvB;AAAL,AAAA,IAAAwB,aAAAD;QAAA,AAAAhB,4CAAAiB,WAAA,IAAA,/DAASvB;uBAAT,AAAAM,4CAAAiB,WAAA,IAAA,9EAAWC;AAAX,AACE,6BAAA,mFAAA,6DAAA,tKAACvB,mBAASF,2NAA2ByB;;AAHxC,AAAA,uIAAAJ,eAAAC,gEAAAD,eAAAC,pOAACvB,oEAAAA,mGAAAA;AAKD,IAAA2B,iBAAA;IAAAC,iBAEC,cAAAC,HAAK5B;AAAL,AAAA,IAAA6B,aAAAD;QAAA,AAAArB,4CAAAsB,WAAA,IAAA,/DAAS5B;WAAT,AAAAM,4CAAAsB,WAAA,IAAA,lEAAWC;AAAX,AACE,6BAAA,mFAAA,6DAAA,tKAAC5B,mBAASF,kOAA8B8B;;AAH3C,AAAA,uIAAAJ,eAAAC,gEAAAD,eAAAC,pOAAC5B,oEAAAA,mGAAAA;AAKD,IAAAgC,iBAAA;IAAAC,iBAEC,cAAAC,HAAKjC;AAAL,AAAA,IAAAkC,aAAAD;QAAA,AAAA1B,4CAAA2B,WAAA,IAAA,/DAASjC;UAAT,AAAAM,4CAAA2B,WAAA,IAAA,jEAAWC;AAAX,AACE,6BAAA,mFAAA,6DAAA,tKAACjC,mBAASF,8NAA4BmC;;AAHzC,AAAA,uIAAAJ,eAAAC,gEAAAD,eAAAC,pOAACjC,oEAAAA,mGAAAA;AAMD,IAAAqC,iBAAA;IAAAC,iBAEC,WAAKrC,GAAGC;AAAR,AACE,yDAAA,mFAAA,6DAAA,lMAACsC,+CAAOvC;;AAHX,AAAA,6HAAAoC,eAAAC,2DAAAD,eAAAC,rNAACC,+DAAAA,8FAAAA;AAKD,IAAAE,iBAAA;IAAAC,iBAEC,WAAKzC,GAAGC;AAAR,AACE,yDAAA,mFAAA,6DAAA,qEAAA,vQAACsC,+CAAOvC;;AAHX,AAAA,6HAAAwC,eAAAC,2DAAAD,eAAAC,rNAACH,+DAAAA,8FAAAA;AAKD,IAAAI,iBAAA;IAAAC,iBAEC,WAAK3C,GAAGC;AAAR,AACE,yDAAA,mFAAA,6DAAA,wEAAA,1QAACsC,+CAAOvC;;AAHX,AAAA,6HAAA0C,eAAAC,2DAAAD,eAAAC,rNAACL,+DAAAA,8FAAAA;AAKD,IAAAM,iBAAA;IAAAC,iBAEC,WAAK7C,GAAGC;AAAR,AACE,yDAAA,mFAAA,6DAAA,lMAACsC,+CAAOvC;;AAHX,AAAA,6HAAA4C,eAAAC,2DAAAD,eAAAC,rNAACP,+DAAAA,8FAAAA;AAKD,IAAAQ,iBAAA;IAAAC,iBAEC,WAAK/C,GAAGC;AAAR,AACE,yDAAA,mFAAA,6DAAA,lMAACsC,+CAAOvC;;AAHX,AAAA,6HAAA8C,eAAAC,2DAAAD,eAAAC,rNAACT,+DAAAA,8FAAAA;AAKD;;;uDAAA,vDAAOU;AAAP,AAGE,mBAAA,AAAAC,fAAMC,+BAAcC;IACdC,eAAa,4DAAA,mFAAA,kEAAA,qDAAA,tQAACb,+CAAOW;AAD3B,AAEEE;;AAEJ;;;oDAAA,pDAAOC,gHAEJD;AAFH,AAGE,IAAAE,iBAAA,mFAAA;AAAA,AAAA,+HAAAA,4DAAAA,1LAACC,gEAAAA,gFAAAA;;AACD,8CAAA,2CAAA,2DAAA,2CAAA,sFAAA,2CAAA,yEAAA,2CAAA,0FAAA,vgBAACC,kfAEkCJ,kFACvB,WAAKK;AAAL,AACE,IAAAC,qBAAuB,AAAA,oHAAyBD;AAAhD,AAAA,oBAAAC;AAAA,oBAAAA,hBAASlD;AAAT,AACE,IAAAmD,WAAA,mFAAA,oFAAqCnD;AAArC,AAAA,sIAAAmD,sDAAAA,pLAACJ,gEAAAA,0EAAAA;;AACD,IAAAK,WAAA,mFAAA,+EAAmC,qBAAA,rBAACC;AAApC,AAAA,sIAAAD,sDAAAA,pLAACL,gEAAAA,0EAAAA;;;;AAEnB;;;oDAAA,pDAAOO,gHAEJV,aAAaW,SAASC;AAFzB,AAGE,8CAAA,2CAAA,2DAAA,2CAAA,4FAAA,2CAAA,sFAAA,yEAAA,2CAAA,0FAAA,nmBAACR,4XACiDO,kNACfX,kFACvBY;;AAEd;;;sDAAA,tDAAOC,oHAEJb,aAAac,eAAepC,KAAKkC;AAFpC,AAGE,IAAMG,YAAU,KAAAC;IACVC,aAAW,CAAA,kEAAA,dAAajB;AAD9B,AAIE,iBAAA,jBAASe,iCAA0BD;;AAGnC,oBAAMpC;AAAN,AACE,iBAAA,jBAASqC,wBAAiBrC;;AAD5B;;OAII,iBAAA,YAAA,7BAACwC,MAASD,uCAEWF,7CACrB,+DAAO,WAAKV,1EAEZ,PAEA;AAJO,AACE,OAAOA;SACT,WAAKc;AAAL,AACE,IAAAC,WAAU,iHAAA,2EAAA,5LAACC,0DAAQF;AAAnB,AAAA,wFAAAC,+BAAAA,/GAACR,yCAAAA,mDAAAA;UACF,WAAKnD;AAAL,AACE,yGAAA,zGAAC6D,yHAAwB7D;;AACzB,IAAA8D,WAAA,2CAAA,2DAAA,MAAA,uDAAiC,4CAAK9D;AAAtC,AAAA,wFAAA8D,+BAAAA,/GAACX,yCAAAA,mDAAAA;;;AAEnB;;;2DAAA,3DAAOY;AAAP,AAAA,qHAAA,2CAAA,kJAAA,xNAGGC,4HACQ,qBAAA,rBAAChB,gKACK,qBAAA,rBAACA;;AAElB;;;yDAAA,zDAAOiB,0HAEJC;AAFH,AAGE,IAAMjD,QAASiD,DAAmB,CAAA,AAAA,eAAA;AAAlC,AACE,IAAAC,iBAAA,mFAAA,6FAA0ClD;AAA1C,AAAA,+HAAAkD,4DAAAA,1LAACzB,gEAAAA,gFAAAA;;AACD,oBAAMzB;AAAN,AACE,yGAAA,zGAAC4C,0HAAyB,AAAQ5C;;AAElC,IAAMmD,SAAO,KAAAC;AAAb,AACE,CAAM,AAAUD,gBACV,WAAKF;AAAL,AACE,IAAAI,WAAA,mFAAA,yFAAwC,AAAA,AAAIJ;AAA5C,AAAA,sIAAAI,sDAAAA,pLAAC5B,gEAAAA,0EAAAA;;;AACT,OAAgB0B,qBAAOnD;;AAP3B;;;AASJ;;;4DAAA,5DAAOsD;AAAP,AAGE,uBAAA,AAAAnC,nBAAMxB,mCAAY,iBAAA4D,WAAA,mFAAA;AAAA,AAAA,wIAAAA,uDAAAA,vLAACC,iEAAAA,2EAAAA;;oBAAnB,AAAArC,hBACMsC,gCAAe,iBAAAC,WAAA,mFAAA;AAAA,AAAA,wIAAAA,uDAAAA,vLAACF,iEAAAA,2EAAAA;;kBADtB,AAAArC,dAEMwC,8BAAa,iBAAAC,WAAA,mFAAA;AAAA,AAAA,wIAAAA,uDAAAA,vLAACJ,iEAAAA,2EAAAA;;eAFpB,AAAArC,XAGMc,2BAAU,iBAAA4B,WAAA,mFAAA;AAAA,AAAA,wIAAAA,uDAAAA,vLAACL,iEAAAA,2EAAAA;;IACXM,oBAAkB,wDAAA,mFAAA,qEAAA,hNAACrD,+CAAOwB;AAJhC,AAKE,oBACEtC;AADF,0FAAA,mDAAA,2CAAA,uDAAA,2CAAA,uDAAA,UAAA,gEAAA,WAAA,sEAAA,yBAGG,qBAAA,rBAACoC;;AAHJ,oBAKE0B;AALF,0FAAA,q5CAAA,mFAAA,mDAAA,2CAAA,uDAAA,2CAAA,uDAAA,UAAA,gEAAA,WAAA,sEAAA,+PAAA,mFAAA,mDAAA,2CAAA,uDAAA,2CAAA,uDAAA,UAAA,gEAAA,19EAQG,+BAAA,AAAA,mFAAA,mDAAA,2CAAA,uDAAA,2CAAA,sEAAA,uBAAA,mFAAA,mDAAA,2CAAA,gEAAA,4JAAA,uDAAA,2CAAA,gEAAA,QAAA,iEAAA,QAAA,sEAAA,MAAA,iEAAA,4BAAA,0DAAA,QAAA,yDAAA,yCAAA,10CAAME,kmBAESA,6DACA,qBAAA,rBAAC5B,+qCAQf,+IAAA,lGAAK,qBAAA,rBAACA,mJAA+B,AAAQ0B,odAE7C,qBAAA,rBAAC1B;;AArBL,oBAwBE+B;AAxBF,0FAAA,mDAAA,mFAAA,mDAAA,2CAAA,uDAAA,2CAAA,sEAAA,uBAAA,mFAAA,mDAAA,2CAAA,sEAAA,kKAAA,uDAAA,2CAAA,gEAAA,QAAA,iEAAA,QAAA,sEAAA,MAAA,iEAAA,4BAAA,0DAAA,QAAA,yDAAA,yCAAA,mFAAA,mDAAA,2CAAA,uDAAA,2CAAA,uDAAA,UAAA,gEAAA,WAAA,sEAAA,0IAAA,mFAAA,mDAAA,2CAAA,uDAAA,2CAAA,uDAAA,UAAA,gEAAA,vvDA2BgBA,mEACA,qBAAA,rBAAC/B,+qCAQb,qBAAA,rBAACA,+hBAED,qBAAA,rBAACA;;AAtCL,AAAA,0FAAA,mDAAA,mFAAA,mDAAA,2CAAA,uDAAA,2CAAA,uDAAA,UAAA,gEAAA,WAAA,sEAAA,2IAAA,mFAAA,mDAAA,2CAAA,uDAAA,2CAAA,uDAAA,UAAA,gEAAA,tgBA2CI,qBAAA,rBAACA,giBAED,qBAAA,rBAACA;;;;;;AAET;;;0DAAA,1DAAOgC;AAAP,AAGE,uBAAA,AAAA5C,nBAAMxB,mCAAY,iBAAAqE,WAAA,mFAAA;AAAA,AAAA,wIAAAA,uDAAAA,vLAACR,iEAAAA,2EAAAA;;AAAnB,AAAA,0FAAA,mDAAA,2CAAA,uDAAA,2CAAA,sEAAA,SAAA,2DAAA,SAAA,yDAAA,oBAAA,sEAAA,OAAA,iEAAA,0BAAA,mFAAA,iDAAA,2CAAA,uDAAA,2CAAA,gEAAA,WAAA,mEAAA,MAAA,sEAAA,OAAA,uDAAA,6IAAA,mFAAA,8CAAA,2CAAA,uDAAA,2CAAA,uDAAA,UAAA,sEAAA,OAAA,gEAAA,qJAAA,mFAAA,mDAAA,2CAAA,uDAAA,2CAAA,yDAAA,qBAAA,sEAAA,MAAA,2DAAA,OAAA,iEAAA,SAAA,iEAAA,0BAAA,mFAAA,sDAAA,2CAAA,qDAAA,OAAA,kDAAA,cAAA,yDAAA,UAAA,uDAAA,2CAAA,0DAAA,eAAA,sIAAA,mFAAA,uDAAA,2CAAA,oDAAA,cAAA,uDAAA,2CAAA,sHAAA,gHAAA,mEAAA,sBAAA,prFAGI,qBAAA,rBAACzB,0mBAED,qBAAA,rBAACA,22CAMmBiB,ydAEK,oCAAA,cAAA,hCAAIrD,kGACL,oCAAA,UAAA,5BAAIA,mNAE1B2D;;AAER;;;2DAAA,3DAAOW;AAAP,AAGE,eAAA,AAAA9C,XAAMc,2BAAU,iBAAAoC,WAAA,mFAAA;AAAA,AAAA,wIAAAA,uDAAAA,vLAACb,iEAAAA,2EAAAA;;AAAjB,AAAA,0FAAA,mDAAA,2CAAA,uDAAA,2CAAA,sEAAA,yBAAA,mFAAA,uDAAA,2CAAA,uDAAA,2CAAA,0DAAA,QAAA,mEAAA,MAAA,sEAAA,UAAA,uDAAA,UAAA,gEAAA,4IAAA,mFAAA,sDAAA,2CAAA,qDAAA,OAAA,8VAAA,0MAAA,uDAAA,2CAAA,uDAAA,OAAA,2DAAA,gBAAA,yDAAA,oBAAA,sEAAA,MAAA,gEAAA,OAAA,mEAAA,MAAA,gEAAA,qCAAA,0DAAA,eAAA,+DAAA,WAAAU,zpDAGI,qBAAA,rBAACnC,2ZAEc,wDAAA,mFAAA,0EAAA,+EAAA,pSAACtB,+CAAOwB,4TACF,qBAAA,rBAACF;AAN1B,AAewB,IAAAuC,WAAA,mFAAA,oFAAA,mFAAA,0EAAA,+EAAyE,AAAA,AAAAJ;AAAzE,AAAA,sIAAAI,sDAAAA,pLAAC7C,gEAAAA,0EAAAA;GAfzB,4DAAA,WAAA0C;AAAA,AAgBuB,qDAAA,7CAAM,AAAA,AAAA,AAAAA;GAhB7B,0DAAA,WAAAC;AAAA,AAiBsB,qDAAA,7CAAM,AAAA,AAAA,AAAAA;;;AAE9B;;;2DAAA,3DAAOG,8HAEJjD,aAAaK;AAFhB,AAGE,IAAA6C,iBAAA,mFAAA,sFAAA;AAAA,AAAA,+HAAAA,4DAAAA,1LAAC/C,gEAAAA,gFAAAA;;AACD,oBAAI,AAAA,yFAAUE;AACZ,AACE,yGAAA,zGAACiB;;AACD,oBAAM,AAAA,sGAAgBjB;AAAtB,AACE,yGAAA,zGAACiB,0HAAyB,AAAA,4FAAWjB;;AADvC;;AAEA,oBAAM,AAAA,uHAAyBA;AAA/B,AACE,yGAAA,zGAACiB;;AADH;;AAEA,IAAA6B,iBAAA,mFAAA,6FAAA;AAAA,AAAA,+HAAAA,4DAAAA,1LAAChD,gEAAAA,gFAAAA;;AACD,IAAAiD,iBAAA,mFAAA,yFAAA;AAAA,AAAA,+HAAAA,4DAAAA,1LAACjD,gEAAAA,gFAAAA;;AAED,OAACF,kDAAcD;;AACjB,gHAAA,zGAACsB,kIAAiC,AAAA,qFAAQjB;;;AAE9C;;;wDAAA,xDAAOgD,wHAEJrD;AAFH,AAGE,eAAA,AAAAH,XAAMc,2BAAU,iBAAA2C,WAAA,mFAAA;AAAA,AAAA,wIAAAA,uDAAAA,vLAACpB,iEAAAA,2EAAAA;;oBAAjB,AAAArC,hBACMsC,gCAAe,iBAAAoB,WAAA,mFAAA;AAAA,AAAA,wIAAAA,uDAAAA,vLAACrB,iEAAAA,2EAAAA;;IAChBpB,iBAAe,wDAAA,mFAAA,0EAAA,rNAAC3B,+CAAOwB;AAF7B,AAGE,IAAA6C,iBAAA,mFAAA,sFAAA;AAAA,AAAA,+HAAAA,4DAAAA,1LAACrD,gEAAAA,gFAAAA;;AACD,OAACU,oDAAgBb,aAAac,eAAeqB,cAC5B,AAACsB,gDAAQR,yDAAqBjD;;AAEnD;;;kDAAA,lDAAO0D,4GAEJ1D;AAFH,AAGE,qBAAA,AAAAH,jBAAM8D,iCAAU,iBAAAC,WAAA,mFAAA;AAAA,AAAA,wIAAAA,uDAAAA,vLAAC1B,iEAAAA,2EAAAA;;uBAAjB,AAAArC,nBACMxB,mCAAY,iBAAAwF,WAAA,mFAAA;AAAA,AAAA,wIAAAA,uDAAAA,vLAAC3B,iEAAAA,2EAAAA;;AADnB,AAAA,0FAAA,8EAAA,2CAAA,uDAAA,2CAAA,gEAAA,uBAAA,sHAAA,2CAAA,2DAAA,0DAAA,nMAGI4B,gQAEW,iBAAAC,mBAAIJ;AAAJ,AAAA,oBAAAI;AAAAA;;AAAa1F;;KAL5B,6DAAA;AAAA,AAMgB,OAACgF,sDAAkBrD;GANnC,sDAOW,kBAAI,iBAAA+D,mBAAIJ;AAAJ,AAAA,oBAAAI;AAAAA;;AAAa1F;;MAAY,qBAAA,rBAACoC,4FAAwB,qBAAA,rBAACA;;AAEpE;;;4DAAA,5DAAOuD,gIAEJhE;AAFH,AAAA,0FAAA,mDAAA,2CAAA,uDAAA,2CAAA,gEAAA,wBAAA,oJAAA,mJAAA,pNAII2C,oJACAF,mJACAiB,gDAAY1D;;AAEhB;;;oDAAA,pDAAMiE,gHAEHjE;AAFH,AAGE,+BAAA,2CAAA,1EAACkE,kIACQ;AAAA,AACE,yGAAA,zGAAC5C,qJAAoDtB;;AACrD,OAACC,kDAAcD;GAH1B,wDAAA,CAIeA;;AAEf,eAAA,AAAAH,XAAMc,2BAAU,iBAAAwD,WAAA,mFAAA;AAAA,AAAA,wIAAAA,uDAAAA,vLAACjC,iEAAAA,2EAAAA;;qBAAjB,AAAArC,jBACM8D,iCAAU,iBAAAS,WAAA,mFAAA;AAAA,AAAA,wIAAAA,uDAAAA,vLAAClC,iEAAAA,2EAAAA;;AADjB,AAAA,0FAAA,8EAAA,mFAGIV,iEACD;AACE,yGAAA,zGAACF,kIAAiCX;;AAClC,yGAAA,zGAACW,2HAA0BqC;;AAC3B,yGAAA,zGAACrC,mIAAkC,AAAC+C,mBAAQ1D;;AAC5C,oBACEgD;AADF,0FAAA,mDAEQ,qBAAA,rBAAClD;;AAFT,oBAIEE;AAJF,0FAAA,mDAAA,mFAKSqD,0DAAsBhE;;AAL/B,AAAA,0FAAA,mDAQQ,qBAAA,rBAACS;;;;;;;AAEhB;;;oDAAA,pDAAM6D;AAAN,AAGE,IAAMtE,eAAa,AAACJ;AAApB,AAAA,0FAAA,mDAAA,2CAAA,uDAAA,2CAAA,gEAAA,SAAA,yDAAA,SAAA,2DAAA,uBAAA,mFAEIqE,kDAAcjE","names":["G__28363","G__28364","zero.frontend.re-frame/reg-event-db","db","_","cljs.core/assoc-in","G__28366","G__28367","p__28368","vec__28369","cljs.core.nth","settings-data","G__28372","G__28373","p__28374","vec__28375","error","G__28382","G__28383","p__28384","vec__28388","path","value","cljs.core.concat","G__28394","G__28395","p__28396","vec__28397","uploading?","G__28400","G__28401","p__28402","vec__28403","file","G__28406","G__28407","p__28408","vec__28409","url","G__28416","G__28417","zero.frontend.re-frame/reg-sub","cljs.core.get_in","G__28418","G__28419","G__28420","G__28421","G__28422","G__28423","G__28424","G__28425","features.app.settings.frontend.view/get-workspace-id","cljs.core/deref","router-state","router.frontend.zero/state","workspace-id","features.app.settings.frontend.view/load-settings","G__28427","zero.frontend.re-frame/dispatch","parquery.frontend.request/send-queries","response","temp__5821__auto__","G__28428","G__28429","translations.core/tr","features.app.settings.frontend.view/save-settings","settings","callback","features.app.settings.frontend.view/submit-settings","workspace-name","form-data","js/FormData","upload-url","js/fetch","data","G__28430","cljs.core.js__GT_clj","cljs.core.println","G__28431","features.app.settings.frontend.view/settings-page-header","ui.page-header/page-header","features.app.settings.frontend.view/handle-file-select","e","G__28432","reader","js/FileReader","G__28433","features.app.settings.frontend.view/upload-status-display","G__28434","zero.frontend.re-frame/subscribe","selected-file","G__28435","preview-url","G__28436","G__28437","existing-logo-url","features.app.settings.frontend.view/logo-upload-section","G__28438","features.app.settings.frontend.view/workspace-name-input","p1__28439#","p1__28440#","p1__28441#","G__28442","G__28443","features.app.settings.frontend.view/handle-save-response","G__28444","G__28445","G__28446","features.app.settings.frontend.view/handle-save-click","G__28447","G__28448","G__28449","cljs.core.partial","features.app.settings.frontend.view/save-button","loading?","G__28450","G__28451","ui.enhanced-button/enhanced-button","or__5025__auto__","features.app.settings.frontend.view/settings-form-content","features.app.settings.frontend.view/settings-form","zero.frontend.react/use-effect","G__28453","G__28454","cljs.core/boolean","features.app.settings.frontend.view/settings-page"],"sourcesContent":["(ns features.app.settings.frontend.view\n  \"Settings view for workspace configuration\"\n  (:require [reagent.core :as r]\n            [parquery.frontend.request :as parquery]\n            [router.frontend.zero :as router]\n            [zero.frontend.re-frame :as rf]\n            [zero.frontend.react :as zero-react]\n            [ui.form-field :as form-field]\n            [ui.enhanced-button :as enhanced-button]\n            [ui.page-header :as page-header]\n            [translations.core :as tr]))\n\n;; Re-frame Events\n(rf/reg-event-db\n :settings/load-start\n (fn [db _]\n   (assoc-in db [:settings :loading?] true)))\n\n(rf/reg-event-db\n :settings/load-success\n (fn [db [_ settings-data]]\n   (-> db\n       (assoc-in [:settings :data] settings-data)\n       (assoc-in [:settings :loading?] false))))\n\n(rf/reg-event-db\n :settings/load-error\n (fn [db [_ error]]\n   (-> db\n       (assoc-in [:settings :error] error)\n       (assoc-in [:settings :loading?] false))))\n\n(rf/reg-event-db\n :settings/update-field\n (fn [db [_ path value]]\n   (assoc-in db (concat [:settings :data] path) value)))\n\n(rf/reg-event-db\n :settings/set-uploading\n (fn [db [_ uploading?]]\n   (assoc-in db [:settings :uploading?] uploading?)))\n\n(rf/reg-event-db\n :settings/set-selected-file\n (fn [db [_ file]]\n   (assoc-in db [:settings :selected-file] file)))\n\n(rf/reg-event-db\n :settings/set-preview-url\n (fn [db [_ url]]\n   (assoc-in db [:settings :preview-url] url)))\n\n;; Re-frame Subscriptions\n(rf/reg-sub\n :settings/data\n (fn [db _]\n   (get-in db [:settings :data])))\n\n(rf/reg-sub\n :settings/loading?\n (fn [db _]\n   (get-in db [:settings :loading?] false)))\n\n(rf/reg-sub\n :settings/uploading?\n (fn [db _]\n   (get-in db [:settings :uploading?] false)))\n\n(rf/reg-sub\n :settings/selected-file\n (fn [db _]\n   (get-in db [:settings :selected-file])))\n\n(rf/reg-sub\n :settings/preview-url\n (fn [db _]\n   (get-in db [:settings :preview-url])))\n\n(defn- get-workspace-id\n  \"Get workspace ID from router parameters\"\n  []\n  (let [router-state @router/state\n        workspace-id (get-in router-state [:parameters :path :workspace-id])]\n    workspace-id))\n\n(defn- load-settings\n  \"Load workspace settings\"\n  [workspace-id]\n  (rf/dispatch [:settings/load-start])\n  (parquery/send-queries\n   {:queries {:workspace-settings/get {}}\n    :parquery/context {:workspace-id workspace-id}\n    :callback (fn [response]\n                (if-let [settings-data (:workspace-settings/get response)]\n                  (rf/dispatch [:settings/load-success settings-data])\n                  (rf/dispatch [:settings/load-error (tr/tr :settings/error-no-data)])))}))\n\n(defn- save-settings\n  \"Save workspace settings\"\n  [workspace-id settings callback]\n  (parquery/send-queries\n   {:queries {:workspace-settings/update {:settings settings}}\n    :parquery/context {:workspace-id workspace-id}\n    :callback callback}))\n\n(defn- submit-settings\n  \"Submit settings via multipart form (both workspace name and optional file)\"\n  [workspace-id workspace-name file callback]\n  (let [form-data (js/FormData.)\n        upload-url (str \"/app/\" workspace-id \"/settings/upload-logo\")]\n    \n    ;; Add workspace name to form data\n    (.append form-data \"workspaceName\" workspace-name)\n    \n    ;; Add file to form data if provided\n    (when file\n      (.append form-data \"file\" file))\n    \n    ;; Send multipart request\n    (-> (js/fetch upload-url\n                  #js {:method \"POST\"\n                       :body form-data})\n        (.then (fn [response]\n                 (.json response)))\n        (.then (fn [data]\n                 (callback (js->clj data :keywordize-keys true))))\n        (.catch (fn [error]\n                  (println \"Upload error:\" error)\n                  (callback {:success false :error (str error)}))))))\n\n(defn- settings-page-header\n  \"Page header for settings page using consistent UI component\"\n  []\n  [page-header/page-header\n   {:title (tr/tr :settings/title)\n    :description (tr/tr :settings/description)}])\n\n(defn- handle-file-select\n  \"Handle file selection for logo upload\"\n  [e]\n  (let [file (-> e .-target .-files (aget 0))]\n    (rf/dispatch [:settings/set-selected-file file])\n    (when file\n      (println \"Selected file:\" (.-name file))\n      ;; Create preview URL for selected image\n      (let [reader (js/FileReader.)]\n        (set! (.-onload reader)\n              (fn [e]\n                (rf/dispatch [:settings/set-preview-url (-> e .-target .-result)])))\n        (.readAsDataURL reader file)))))\n\n(defn- upload-status-display\n  \"Display upload status and file selection\"\n  []\n  (let [uploading? @(rf/subscribe [:settings/uploading?])\n        selected-file @(rf/subscribe [:settings/selected-file])\n        preview-url @(rf/subscribe [:settings/preview-url])\n        settings @(rf/subscribe [:settings/data])\n        existing-logo-url (get-in settings [:settings/logo :logo-url])]\n    (cond\n      uploading?\n      [:div {:style {:color \"#9ca3af\" :font-size \"0.875rem\" :margin-bottom \"0.5rem\"}}\n       (tr/tr :settings/uploading)]\n      \n      selected-file\n      [:div\n       ;; Image preview (new file selected)\n       (when preview-url\n         [:div {:style {:margin-bottom \"1rem\"}}\n          [:img {:src preview-url\n                 :alt (tr/tr :settings/logo-preview)\n                 :style {:max-width \"200px\"\n                         :max-height \"150px\"\n                         :border-radius \"8px\"\n                         :box-shadow \"0 2px 4px rgba(0,0,0,0.1)\"\n                         :display \"block\"\n                         :margin \"0 auto\"}}]])\n       [:div {:style {:color \"#10b981\" :font-size \"0.875rem\" :margin-bottom \"0.5rem\"}}\n        (str (tr/tr :settings/selected) \": \" (.-name selected-file))]\n       [:div {:style {:color \"#6b7280\" :font-size \"0.75rem\"}}\n        (tr/tr :settings/click-different)]]\n      \n      ;; Show existing logo if available\n      existing-logo-url\n      [:div\n       [:div {:style {:margin-bottom \"1rem\"}}\n        [:img {:src existing-logo-url\n               :alt (tr/tr :settings/current-logo-alt)\n               :style {:max-width \"200px\"\n                       :max-height \"150px\"\n                       :border-radius \"8px\"\n                       :box-shadow \"0 2px 4px rgba(0,0,0,0.1)\"\n                       :display \"block\"\n                       :margin \"0 auto\"}}]]\n       [:div {:style {:color \"#6b7280\" :font-size \"0.875rem\" :margin-bottom \"0.5rem\"}}\n        (tr/tr :settings/current-logo)]\n       [:div {:style {:color \"#6b7280\" :font-size \"0.75rem\"}}\n        (tr/tr :settings/upload-new)]]\n      \n      :else\n      [:div\n       [:div {:style {:color \"#9ca3af\" :font-size \"0.875rem\" :margin-bottom \"0.5rem\"}}\n        (tr/tr :settings/click-upload)]\n       [:div {:style {:color \"#6b7280\" :font-size \"0.75rem\"}}\n        (tr/tr :settings/supported-formats)]])))\n\n(defn- logo-upload-section\n  \"Company logo upload section\"\n  []\n  (let [uploading? @(rf/subscribe [:settings/uploading?])]\n    [:div {:style {:margin-bottom \"2.5rem\" :padding \"1.5rem\" :border \"1px solid #e5e7eb\" :border-radius \"12px\" :background \"#f9fafb\"}}\n     [:h4 {:style {:font-size \"1.125rem\" :font-weight \"600\" :margin-bottom \"1rem\" :color \"#374151\"}}\n      (tr/tr :settings/company-logo)]\n     [:p {:style {:color \"#6b7280\" :margin-bottom \"1rem\" :font-size \"0.875rem\"}}\n      (tr/tr :settings/logo-description)]\n     [:div {:style {:border \"2px dashed #d1d5db\" :border-radius \"8px\" :padding \"2rem\" :text-align \"center\" :background \"#ffffff\"}}\n      [:input {:type \"file\"\n               :id \"logo-upload\"\n               :accept \"image/*\"\n               :style {:display \"none\"}\n               :on-change handle-file-select}]\n      [:label {:for \"logo-upload\"\n               :style {:cursor (if uploading? \"not-allowed\" \"pointer\") \n                       :color (if uploading? \"#9ca3af\" \"#3b82f6\") \n                       :font-weight \"500\"}}\n       [upload-status-display]]]]))\n\n(defn- workspace-name-input\n  \"Workspace name input field\"\n  []\n  (let [settings @(rf/subscribe [:settings/data])]\n    [:div {:style {:margin-bottom \"2.5rem\"}}\n     [:label {:style {:display \"block\" :font-weight \"600\" :margin-bottom \"0.75rem\" :color \"#374151\" :font-size \"1rem\"}}\n      (tr/tr :settings/workspace-name)]\n     [:input {:type \"text\"\n              :value (get-in settings [:settings/general :workspace/name] \"\")\n              :placeholder (tr/tr :settings/workspace-name-placeholder)\n              :style {:width \"100%\" \n                      :padding \"0.875rem 1rem\" \n                      :border \"1px solid #d1d5db\" \n                      :border-radius \"8px\"\n                      :font-size \"1rem\"\n                      :line-height \"1.5\"\n                      :transition \"border-color 0.2s, box-shadow 0.2s\"\n                      :outline \"none\"}\n              :on-change #(rf/dispatch [:settings/update-field [:settings/general :workspace/name] (.. % -target -value)])\n              :on-focus #(set! (.. % -target -style -border-color) \"#3b82f6\")\n              :on-blur #(set! (.. % -target -style -border-color) \"#d1d5db\")}]]))\n\n(defn- handle-save-response\n  \"Handle save response\"\n  [workspace-id response]\n  (rf/dispatch [:settings/set-uploading false])\n  (if (:success response)\n    (do\n      (println \"Settings saved successfully!\")\n      (when (:file-uploaded response)\n        (println \"Logo uploaded:\" (:filename response)))\n      (when (:workspace-name-updated response)\n        (println \"Workspace name updated\"))\n      (rf/dispatch [:settings/set-selected-file nil])\n      (rf/dispatch [:settings/set-preview-url nil])\n      ;; Reload settings to show updated logo\n      (load-settings workspace-id))\n    (println \"Error saving settings:\" (:error response))))\n\n(defn- handle-save-click\n  \"Handle save button click\"\n  [workspace-id]\n  (let [settings @(rf/subscribe [:settings/data])\n        selected-file @(rf/subscribe [:settings/selected-file])\n        workspace-name (get-in settings [:settings/general :workspace/name])]\n    (rf/dispatch [:settings/set-uploading true])\n    (submit-settings workspace-id workspace-name selected-file \n                     (partial handle-save-response workspace-id))))\n\n(defn- save-button\n  \"Save settings button\"\n  [workspace-id]\n  (let [loading? @(rf/subscribe [:settings/loading?])\n        uploading? @(rf/subscribe [:settings/uploading?])]\n    [:div.form-actions {:style {:margin-top \"2rem\"}}\n     [enhanced-button/enhanced-button\n      {:variant :primary\n       :loading? (or loading? uploading?)\n       :on-click #(handle-save-click workspace-id)\n       :text (if (or loading? uploading?) (tr/tr :settings/saving) (tr/tr :settings/save-settings))}]]))\n\n(defn- settings-form-content\n  \"Main settings form content\"\n  [workspace-id]\n  [:div {:style {:max-width \"600px\"}}\n   [workspace-name-input]\n   [logo-upload-section]\n   [save-button workspace-id]])\n\n(defn settings-form\n  \"Settings form component\"\n  [workspace-id]\n  (zero-react/use-effect\n   {:mount (fn []\n             (println \"DEBUG: Loading settings for workspace-id:\" workspace-id)\n             (load-settings workspace-id))\n    :params #js [workspace-id]})\n  \n  (let [settings @(rf/subscribe [:settings/data])\n        loading? @(rf/subscribe [:settings/loading?])]\n    [:div.settings-form\n     [settings-page-header]\n     (do \n       (println \"DEBUG: settings value:\" settings)\n       (println \"DEBUG: loading?\" loading?)\n       (println \"DEBUG: settings exists?\" (boolean settings))\n       (cond\n         loading?\n         [:div (tr/tr :settings/loading-settings)]\n         \n         settings\n         [:div [settings-form-content workspace-id]]\n         \n         :else\n         [:div (tr/tr :settings/no-settings)]))]))\n\n(defn settings-page\n  \"Main settings page component\"\n  []\n  (let [workspace-id (get-workspace-id)]\n    [:div {:style {:max-width \"1200px\" :margin \"0 auto\" :padding \"2rem\"}}\n     [settings-form workspace-id]]))"]}
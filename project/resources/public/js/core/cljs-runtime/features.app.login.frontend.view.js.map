{"version":3,"sources":["features/app/login/frontend/view.cljs"],"mappings":"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","names":["features.app.login.frontend.view/login-form","form-data","reagent.core.atom","errors","loading?","validate-form","data","username","password","G__39895","cljs.core.assoc","translations.core/tr","handle-login","cljs.core/reset!","validation-errors","cljs.core/deref","cljs.core/seq","parquery.frontend.request/send-queries","response","result","cljs.core._EQ_","js/window","p1__39872#","p1__39877#","e","cljs.core.swap_BANG_","cljs.core/assoc","features.app.login.frontend.view/view"],"sourcesContent":["(ns features.app.login.frontend.view\n  (:require [reagent.core :as r]\n            [parquery.frontend.request :as parquery]\n            [translations.core :as tr]))\n\n(defn login-form []\n  (let [form-data (r/atom {:user/username \"\"\n                           :user/password \"\"})\n        errors (r/atom {})\n        loading? (r/atom false)\n        \n        validate-form (fn [data]\n                        (let [username (:user/username data)\n                              password (:user/password data)]\n                          (cond-> {}\n                            (< (count (str username)) 3)\n                            (assoc :user/username (tr/tr :login/username-min-length))\n                            \n                            (< (count (str password)) 1)\n                            (assoc :user/password (tr/tr :login/password-required)))))\n        \n        handle-login (fn []\n                       (reset! loading? true)\n                       (reset! errors {})\n                       (let [validation-errors (validate-form @form-data)]\n                         (if (seq validation-errors)\n                           (do (reset! errors validation-errors)\n                               (reset! loading? false))\n                           (parquery/send-queries\n                             {:queries {:users/login @form-data}\n                              :parquery/context {}\n                              :callback (fn [response]\n                                          (let [result (:users/login response)]\n                                            (reset! loading? false)\n                                            (if (:success result)\n                                              (cond\n                                                (= \"superadmin\" (:user/role result))\n                                                (set! (.-location js/window) \"/superadmin\")\n                                                \n                                                (:user/workspace-id result)\n                                                (set! (.-location js/window) (str \"/app/\" (:user/workspace-id result)))\n                                                \n                                                :else\n                                                (set! (.-location js/window) \"/app\"))\n                                              (reset! errors {:general (:error result)}))))}))))]\n    \n    (fn []\n      [:div {:style {:min-height \"100vh\"\n                     :display \"flex\" \n                     :align-items \"center\"\n                     :justify-content \"center\"\n                     :background \"linear-gradient(135deg, #ae6e1f 0%, #72a9bf 50%, #ae6e1f 100%)\"}}\n       [:div {:style {:background \"white\"\n                      :padding \"2rem\"\n                      :border-radius \"8px\"\n                      :box-shadow \"0 4px 6px rgba(0, 0, 0, 0.1)\"\n                      :width \"400px\"\n                      :max-width \"90vw\"}}\n        [:div {:style {:display \"flex\"\n                       :align-items \"center\"\n                       :justify-content \"center\"\n                       :gap \"12px\"\n                       :margin-bottom \"1.5rem\"}}\n         [:img {:src \"/logo/logo-256.webp\"\n                :alt \"Logo\"\n                :style {:height \"50px\"\n                        :width \"50px\"\n                        :border-radius \"12px\"\n                        :object-fit \"cover\"}}]\n         [:h2 {:style {:margin \"0\"\n                       :color \"#ae6e1f\"\n                       :font-family \"'Dancing Script', cursive\"\n                       :font-size \"2rem\"\n                       :font-weight \"700\"}}\n          (tr/tr :header/brand)]]\n        [:p {:style {:text-align \"center\"\n                     :margin-bottom \"1.5rem\"\n                     :color \"#666\"\n                     :font-size \"1rem\"}}\n         (tr/tr :login/title)]\n        \n        (when (:general @errors)\n          [:div {:style {:background \"#f8d7da\"\n                         :border \"1px solid #f5c6cb\"\n                         :color \"#721c24\"\n                         :padding \"0.75rem\"\n                         :border-radius \"4px\"\n                         :margin-bottom \"1rem\"}}\n           (:general @errors)])\n        \n        [:form {:on-submit (fn [e]\n                             (.preventDefault e)\n                             (handle-login))}\n         [:div {:style {:margin-bottom \"1rem\"}}\n          [:label {:style {:display \"block\"\n                           :margin-bottom \"0.5rem\"\n                           :font-weight \"bold\"\n                           :color (if (:user/username @errors) \"#dc3545\" \"inherit\")}}\n           (tr/tr :login/username)]\n          [:input {:type \"text\"\n                   :value (:user/username @form-data)\n                   :on-change #(swap! form-data assoc :user/username (.. % -target -value))\n                   :placeholder (tr/tr :login/username-placeholder)\n                   :style {:width \"100%\"\n                           :padding \"0.75rem\"\n                           :border (str \"1px solid \" (if (:user/username @errors) \"#dc3545\" \"#ccc\"))\n                           :border-radius \"4px\"\n                           :font-size \"1rem\"}}]\n          (when (:user/username @errors)\n            [:div {:style {:color \"#dc3545\"\n                           :font-size \"0.875rem\"\n                           :margin-top \"0.25rem\"}}\n             (:user/username @errors)])]\n         \n         [:div {:style {:margin-bottom \"1.5rem\"}}\n          [:label {:style {:display \"block\"\n                           :margin-bottom \"0.5rem\"\n                           :font-weight \"bold\"\n                           :color (if (:user/password @errors) \"#dc3545\" \"inherit\")}}\n           (tr/tr :login/password)]\n          [:input {:type \"password\"\n                   :value (:user/password @form-data)\n                   :on-change #(swap! form-data assoc :user/password (.. % -target -value))\n                   :placeholder (tr/tr :login/password-placeholder)\n                   :style {:width \"100%\"\n                           :padding \"0.75rem\"\n                           :border (str \"1px solid \" (if (:user/password @errors) \"#dc3545\" \"#ccc\"))\n                           :border-radius \"4px\"\n                           :font-size \"1rem\"}}]\n          (when (:user/password @errors)\n            [:div {:style {:color \"#dc3545\"\n                           :font-size \"0.875rem\"\n                           :margin-top \"0.25rem\"}}\n             (:user/password @errors)])]\n         \n         [:button {:type \"submit\"\n                   :disabled @loading?\n                   :style {:width \"100%\"\n                           :padding \"0.75rem\"\n                           :background (if @loading? \"#6c757d\" \"#72a9bf\")\n                           :color \"white\"\n                           :border \"none\"\n                           :border-radius \"4px\"\n                           :font-size \"1rem\"\n                           :cursor (if @loading? \"not-allowed\" \"pointer\")\n                           :opacity (if @loading? 0.6 1)}}\n          (if @loading? (tr/tr :login/logging-in) (tr/tr :login/login))]]]])))\n\n(defn view []\n  [login-form])"]}